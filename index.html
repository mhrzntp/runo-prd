function doGet(e) {
  try {
    const sheet = SpreadsheetApp
      .getActiveSpreadsheet()
      .getSheetByName("Records");

    if (!sheet) {
      throw new Error("Sheet 'Records' not found");
    }

    const bomName = e.parameter.bomName || "";
    const generatedAt = e.parameter.generatedAt || "";
    const summary = e.parameter.summary || "(no summary)";
    const totalCost = Number(e.parameter.totalCost || 0);

    sheet.appendRow([
      bomName,
      generatedAt,
      summary,
      totalCost
    ]);

    return ContentService
      .createTextOutput("OK")
      .setMimeType(ContentService.MimeType.TEXT);

  } catch (err) {
    return ContentService
      .createTextOutput("ERROR: " + err.message)
      .setMimeType(ContentService.MimeType.TEXT);
  }
}
